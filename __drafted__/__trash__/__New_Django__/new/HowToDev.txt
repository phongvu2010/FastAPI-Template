B∆∞·ªõc 1: Kh·ªüi t·∫°o Project Django

D√πng docker-compose run ƒë·ªÉ t·∫°o project Django b√™n trong th∆∞ m·ª•c web
```
docker-compose run --rm web django-admin startproject core .
```

B∆∞·ªõc 2: T·∫°o App cho Custom User

Ch√∫ng ta c·∫ßn Custom User model
```
docker-compose run --rm web python manage.py startapp accounts
```

B∆∞·ªõc 3: C·∫•u h√¨nh settings.py & ƒê·ªãnh nghƒ©a Custom User Model

B∆∞·ªõc 4: Ch·∫°y Stack
```
docker-compose up --build
```

B∆∞·ªõc 5: T·∫°o Migrations
```
docker-compose exec web python manage.py makemigrations
docker-compose exec web python manage.py migrate
```

B∆∞·ªõc 6: T·∫°o t√†i kho·∫£n Superuser Admin ban ƒë·∫ßu (ƒë·ªÉ qu·∫£n l√Ω vai tr√≤)
```
docker-compose exec web python manage.py createsuperuser
```


1. üõë H√†m NgƒÉn Ch·∫∑n Thay ƒê·ªïi (Prevent_Modification_Function)
H√†m n√†y s·∫Ω ƒë∆∞·ª£c k√≠ch ho·∫°t tr∆∞·ªõc b·∫•t k·ª≥ h√†nh ƒë·ªông DELETE ho·∫∑c UPDATE n√†o tr√™n b·∫£ng AuditLog v√† s·∫Ω ngay l·∫≠p t·ª©c tr·∫£ v·ªÅ m·ªôt l·ªói, ngƒÉn ch·∫∑n h√†nh ƒë·ªông ƒë√≥.
SQL
-- SQL: app/documents/migrations/00xx_auditlog_trigger_sql.sql (Ph·∫ßn 1)
--
-- T·∫†O H√ÄM (FUNCTION)
--
CREATE OR REPLACE FUNCTION prevent_audit_log_modification()
RETURNS TRIGGER AS $$
BEGIN
    -- 
    IF TG_OP = 'DELETE' THEN
        RAISE EXCEPTION 'Audit logs are immutable. Deletion of audit log records is forbidden.';
        
    ELSIF TG_OP = 'UPDATE' THEN
        RAISE EXCEPTION 'Audit logs are immutable. Updating audit log records is forbidden.';
    END IF;
    
    -- ƒê·ªëi v·ªõi INSERT, ch√∫ng ta cho ph√©p v√† tr·∫£ v·ªÅ d√≤ng m·ªõi
    RETURN NEW; 
END;
$$ LANGUAGE plpgsql;

2. ‚ö°Ô∏è T·∫°o Trigger Tr√™n B·∫£ng documents_auditlog
Sau khi h√†m ƒë∆∞·ª£c t·∫°o, ch√∫ng ta t·∫°o m·ªôt Trigger ƒë·ªÉ li√™n k·∫øt h√†m ƒë√≥ v·ªõi c√°c s·ª± ki·ªán UPDATE v√† DELETE tr√™n b·∫£ng AuditLog.
L∆∞u √Ω: T√™n b·∫£ng s·∫Ω l√† documents_auditlog n·∫øu b·∫°n ƒë·∫∑t AuditLog model trong app documents.
SQL
-- SQL: app/documents/migrations/00xx_auditlog_trigger_sql.sql (Ph·∫ßn 2)
--
-- T·∫†O TRIGGER
--
CREATE TRIGGER auditlog_immutable_trigger
BEFORE DELETE OR UPDATE ON documents_auditlog
FOR EACH ROW
EXECUTE FUNCTION prevent_audit_log_modification();
